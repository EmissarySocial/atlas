{{- $q := .QueryParam "q" -}}

<nav class="desktop">
	<form hx-get="/home">
		<input id="nav-search" type="search" name="q" value="{{$q}}" placeholder="Search this map with text and #hashtags">
	</form>
</nav>

<div id="sidebar" class="flex-column margin-bottom" hx-push-url="true" hx-swap="transition:true"
style="width:240px; padding:var(--rhythm);">

	{{- range .Navigation -}}
		<a href="/{{.Token}}" id="nav-{{.StreamID}}" class="nav-item turboclick" aria-label="{{.Label}}">
			{{- $icon := .Icon -}}
			{{- if ne "" $icon -}}
				<span class="icon selected-hide">{{icon $icon}}</span>
				<span class="icon selected-show">{{icon (join $icon "-fill")}}</span>
			{{- end }}
			<span class="label">{{.Label}}</span>
		</a>
	{{- end -}}

	<br>

	{{- if .IsAuthenticated -}}
		<a hx-get="/@me/outbox-add" id="nav-outbox-add" class="nav-item turboclick link" aria-label="Profile">
			<span class="icon">{{icon "plus"}}</span>
			<span class="label">Add a Placemark</span>
		</a>

		<br>

		<a href="/@me" id="nav-outbox" class="nav-item turboclick" aria-label="Profile">
			<span class="icon selected-hide">{{icon "user"}}</span>
			<span class="icon selected-show">{{icon "user-fill"}}</span>
			<span class="label">My Profile</span>
		</a>

		<a href="/@me/inbox" id="nav-inbox" class="nav-item turboclick" aria-label="Inbox">
			<span class="icon selected-hide">{{icon "inbox"}}</span>
			<span class="icon selected-show">{{icon "inbox-fill"}}</span>
			<span class="label">My Inbox</span>
		</a>

		<a href="/@me/settings" id="nav-settings" class="nav-item turboclick" aria-label="Settings">
			<span class="icon selected-hide">{{icon "settings"}}</span>
			<span class="icon selected-show">{{icon "settings-fill"}}</span>
			<span class="label">My Settings</span>
		</a>

		{{- if .IsOwner -}}
			<a href="/admin/domain" id="nav-admin" class="nav-item turboclick" aria-label="Server Admin">
			<span class="icon selected-hide">{{icon "server"}}</span>
			<span class="icon selected-show">{{icon "server-fill"}}</span>
				<span class="label">Server Settings</span>
			</a>
		{{- end -}}
		
		<a hx-post="/signout" id="nav-settings" class="nav-item turboclick" aria-label="Sign Out">
			<span class="icon">{{icon "logout"}}</span>
			<span class="label">Sign Out</span>
		</a>

	{{- else if .IsIdentity -}}
		<a href="/@guest" id="nav-settings" class="nav-item turboclick" aria-label="Profile">
			<span class="icon selected-hide">{{icon "user"}}</span>
			<span class="icon selected-show">{{icon "user-fill"}}</span>
			<span class="label">My Profile</span>
		</a>
	{{- else -}}
		<a href="/signin" id="nav-signin" class="nav-item turboclick" aria-label="Sign In">
			<span class="icon">{{icon "user"}}</span>
			<span class="label">Sign In</span>
		</a>
	{{- end -}}

</div>
